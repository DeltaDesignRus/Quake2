! map "trainstation": very slow (10-20ms) server (too much traces ?)
? reimplement "showtrace" (rename cvar, make it with DrawTextXxx(), display every frame (com_speeds too!), update
  every server frame (implemented with com_speeds ?? if so, remove "showtrace" cvar)
! unpack PVS in LoadBsp(); use unpacked version in renderer and CM_InPVS() etc.

!!! check PCX/WAL palette: alpha == 0 for index != 255 ??
KINGPIN:
  ! map "teehc2":
    - have entity "{ *3 }" ("noclass") (KP have error with it too)
  ! map "dm_dukecity"
    - room across the road of disco: have reflections
  - "worldspawn": "sounds"="2" -- what is it?
  - fire/steam
  BUGS with RF2_SURF_ALPHA, map "rc1":
    - "func_explosive"(??) - unbreakable ventillation doors (add flag for server: "don't pass bullets"?)
FAKK:
  ? FS_FileInInPAK(const char *name)
  - qcommon.h: SAVEGAME_DIRECTORY "save", SAVEGAME_EXTENSION "sav", etc.
CAMERA:
  - make FAKK-like camera lift-up when collided with wall
  ? interpolate camera
  ? interpolate duck (1st person)
HALFLIFE:
  // from pm_shader.c
  - step sound: volume = 0.2/0.5 (walk/run) (+ add slowwalk -- crouched)
  - if moving slow - no step sounds
  - walking/running: step sound length = 400/300; water = 600; ladder = 350
  - stop when |velocity| less than STOP_EPSILON==0.1 (friction)

TRACE:
  ? speedup ClipToEntities() (client/server/ref_gl): COMPARE only with entities in range
    (start - trace.endpos)   (trace.endpos frequently updated); can sort ents by distance
    (find a list of potentially collided ents, sort by coord and collide + update collision
    limits with additional refining following traces)
    NOTE: cannot TRACE to (start - trace.endpos) - will produce different trace.frac

! improve server and client communication (server should be able to set map loading screenshot)
? "dir" -> "ls"
! reimplement Cbuf_Execute(): need comment ('//') parsing (should go to another place)
! make screnshots for savegames + display screenshot instead of levelshot on savegame loading
- cvar commands: "push", "pop"; 2 variants:
  a) push <var> , pop <var>     -- each cvar have its ovn stack; "push $a;push $b;pop a;pop b" will not change vars
  b) push <value> , pop <var>   -- global cvar stack; "push a;push b;pop a;pop b" will exchange "a" and "b" values

!? improve SV_ClipMoveToEntities() like CL_ClipMoveToEntities(); don't need SV_AreaEdicts in this function ?
? (when sprite-fx will be implemented) disable REF_NEWFX when necessary image files absent


DINPUT MOUSE BUGS/NOTES:
- in_initmouse -- needed?
- check behaviour when no DirectX installed (where ?)
- add MOUSE4 ?
- check DirectInput8
*? add mouse cursor hiding (not always disappear with DInput after deactivate+activate)

! improve memory management: allocate with alignment of 16 bytes (large blocks only ? Z_AllocAligned(size, align) func ?)
- command for hiding files from pak: "pakhide <pakname> <filemask>" - non-reversive command, changes (be sure non-destructive
  for alpha-sort names) files info so it will not found on next requests
- stop animation within a mouse click (and something another?)
? improve camper detection: track player position every ... 5 sec (??) for a 1+n minute period and set "camper" to true
  if current player position is near (tune this distance !) to history[now-1min .. now-2min]
- menu option: priority (win_priorityBoost) -- for Win2K
? savegames: add screenshot, gzip file

BSP:
? KP map scaling (auto)
? mirrored maps
- commands spmap, devmap etc.
- advanced "map" command syntax: add scaling and mirroring (separate scale each axis, mirror - X *= -1 ?)
  "map [-dev] [-sp] [-mirror] [-scale] <name>" (?!)
? Q1 map support (easier than HL)

*** BUGS ***
! sometimes key_up skipped (or key_down spontaneously pressed)
! (Win2K) when one client exits, server makes "Sys_Error(ERR_DROP,...)" (network error)
- (Win2K, at home, where no IPX protocol) menu|join_server -- fatal error in user32.dll (should be ERR_DROP)
  (no crush when launched with "noudp 1" -- R/O cvar)
- map "temple2", "lavatube" -- waterfall: bullet sounds (change sound for water sparks, change place for water bullet sounds
  or something another ??)
- command line: "+set cddir <dir>" (etc.) - will display error, when var will be parsed 2nd time
- baseq2: "newgame" -- cannot break video and start game
- Sys_Error(ERR_FATAL): will not restore mouse (not always ??!)
- dedicated server: work without ref, so - crush when try some things (i.e. "com_speeds 1") --> make fake ref
  (and add support for colors, scrolling etc.)
- map "ground3_beta3": have (server, "MAX_ENTS=128"- related ?) bug "SZ_Overflow" (??) when spectating and flying from inside wall
  (see cl_ents.c MAX_PARSE_ENTITIES: seems, no more than 128 entities delta between frames)
- prediction:
  - map "beachassault": ship's entry, when in "down" state -- drizzle
  - map "japan", lift, 3rd_person, going up with looking up -- camera drizzle (bad collision with lift entity)
  *? have a small grenade-standing drizzle

? menu interface: appearing/disappearing fx (see itmastio etc.)

- chasecam (see Q3 cgame)
? eliminate all qsort's

- bindtmp, aliastmp, aliaslist (now it is "alias <no-args>")

! remove auto-demo start on quake loading (option? timeout? first run?)

! add materials: glass, grass, sand
? make atmospheric effects (some maps in kingpin and halflife does, Q3F too ...)
  (make surface-dependent raindrop sounds? (KP:main/sound/world/rain*.wav))

? SOFT sprites: get sprite size not from md2, but from image dimensions (see new explosions ...); we can do it,
  because GL do this in this way

------------- API ----------------------------

- add Cmd_AddCommands(list,num), Cmd_RemoveCommands(list,num)
  - Cmd_AddCommands() may be implemented WITHOUT copying name, or just with using static cmdFunc_t for list
    (just insert into list, but add flags "do not free on remove")
  - macro CMD_ADD_COMMANDS(var) -> Cmd_AddCommands(var,sizeof(var)/sizeof(*var)) etc.
- add "Cmd_AddHidden()" - for server commands (cannot be completed/listed, but accessible)
  (or just implement with Cmd_AddCommand(), but use name prefix, which will be ignored for seaching/completion,
  but disables completion)
? Com_DWPrintf() -- same as Com_DPrintf(), but display only when "developer" != 0 (or "warnings" != 0 ??)

------------- MENUS --------------------------

- place "download options" to another place (not "player setup", or to upper level: where model selection performed);
  make download options to be a bitfield
- when menu script will be implemented:
  - add developer submenus
  - add Half-Life-like screen action menus (semi-transparent rects with text; accessible with keyboard and mouse)

-------------- CLIENT/SERVER -----------------

- record demos: make .dm2 file to be gzipped (produce with command other than "record"?)
  (may use old command too: who wants to send demo to other players, may just un-gzip it)
? demos with full list of events (already: serverrecord);
  make player for this demos (total control over movement: move, chase, eye etc.)
*? improve movement prediction (lots of bugs, such as "stand-on-grenage drizzle" (fixed?) and "hooked-in opening-door"):
  ? use acceleration (see Q3, HL ??)
? add support for moving ladders: when player on entity with ladder, move player within entity (example: map "mesto", helicopter)
  (seems, this is game code ...)
? improve speed of downloading: limited by qcommon.h::MAX_MSGLEN (used in )
  client: cl_parse.c :: CL_ParseDownload() - net_massege ;; SZ_Print(..,"nextdl")
  server: sv_user.c :: SV_NextDownload_f() - write_size=r (1024 max < MAX_MSGLEN)
? perform extended protocol checking by adding "[cl_]extprotocol" to userinfo
? make pmove player bounds to be taken from the actual player model
? improve model precaching in cl_mail.c::CL_RequestNextDownload() (find FS_LoadFile) - make it with global
  LoadMd2() and global model list ??
? SV_FindIndex() -- use hash tables ?
! try to remove "MAX_ENTS=128" limit (see "BUGS" section, "ground3_beta3")
? server: if game_time is comparable with ref_time, need to Sleep(game_time) every frame between game frames

------------ REF_GL (new) --------------

- R_RecursiveWorldNode():
  3) fog-in-leaf
  4) leaf-use-detailTex
- portals:
  - try software clipplane (1. add to frustum; 2. clip triangles)
  - add 2nd {viewcluster, leaf[].frame} set (1st for main scene, 2nd for portal) -- Q3 has recalculation of leaf visibility
    every frame twice, and without portal - once per few frames.
- better alt-tabbing (with CDS()), better GLimp_InitGL() (reserve stencil (?), gl_depthBits)
- disable auto-envmap when surface not from CONTENTS_WINDOW -- need Trace()/PointContents() to detect 
? place LoadMd2 outside ref_xxx and perform lovercase for a skin names
- use GL_NV_fog_distance (?) / GL_EXT_fog_coord, GL_EXT_texture_filter_anisotropic (?)
! fog occlusion (for global fog) -- implement it like sky (occluded surface -> sky surface, sky -> fog color);
  may look at Alice ...

------------ SOUND ---------------------

? make ladder sounds (if it is possible) - depends on ladder surface type (wood creak etc.)

? add hardware mixing (DirectSound), try DirectSound3D (or OpenAL, or own implementation ??)
  Maps with slow sound fx: beachassault (multiple barrel blast)

- fix stereo sound rotation (bad positioning)

- make camper sounds gender-sensitive; change sounds (get it from Thief II), but let old (current)
  system works with "sv_campersounds 2"
? spectator sounds (windy)
? try to move surface bullet sounds from client to server

----------- VIDEO --------------

? remove non-transparent water vis bugfix from oldgl

- add WriteTGA compression
- PCX: own palette for each file (??)
? h/w gamma: check for valid gamma when read
- video config menu: make "reset to defaults" works correctly (Cvar_Reset() ??)

- add marks: bulletholes, explosion marks, blood, "cheesy shadow", water ripple

- ref_console (Win32 console-mode application, no GDI/OpenGL) -- auto-use in dedicated server (should attach
  dedicated server to ref)
? change "gl_console_only" and "sw_console_only" to "r_consoleOnly"

- decompress visinfo for client (cmodel); share this with renderers (require to modify oldgl and soft)

------------ COMMON --------------

? meminfo (see Alice) - renderer (hunks), z, chains etc. ???
? hunks -> chains; align blocks by 16 bytes (currently: 8)
? own memory manager (without malloc; use OS functions at low-lewel)

*? Z_DEBUG: make following (#ifdef Z_DEBUG)
  - #define Z_BlockMalloc(size) Z_TagMalloc(size,0)
  - #define Z_Malloc(size) Z_TagMalloc(size,0)
  - add "void *caller_addr" to zblock_t and fill it in Z_TagMalloc with a return address
    == "*((int*)first_param - 1)"
  - make checking memory in "z_stats" (show damaged block info's - size, caller address ...)
    anbd Z_Free()

? console command line parsing: add special chars ('\"' etc.)

? implement FS_ListFiles() / FreeNamedList() within a memory chains (not just linked list)
? make AllocChainBlock() will try to use free space of PREVIOUS blocks when current (last) is full

- add cvar "log_texts" -- log text, which was output with DrawText[Left|Right|Pos]();
  value of "2" - log 1 frame and disable

- make zip/* big-endian compatible; update to "zlib1.1.4"
? update JPEG code

!? add Python virtual machine (game library, inline map scripts)

- separate "math.c"; make "MMX", "3D Now!", "SSE" and "common" versions for some functions (all trace functions, ...)
- make some functions #define -> inline (DotProduct etc.)
                                 
------------- CVARS --------------------

? cvarclear - clear all archive flags from cvars, which was not created with quake2 (created with "set <var> <value> a" command)
? cvar_mon varname [message]  - monitor cvar on screen (default message = varname)
? cvar_unmon varname  - stop monitor for cvar
? completion cvarnames after "set", "toggle", "add" (etc.) and "...$varname"
  (add flags for Cmd_AddCommand() - complete type: cvar, map, demo ... ???)
? make completion "dir"-like formatting + colorizing against char-marks (types)

------------- LINUX --------------------

- check all "#pragma pack" places
- check Sys_FindFirst/FindNext/FindClose to work correctly (on Win32 was a bug: when canthave=DIR and 1st match
  found is a directory (".",".." or other) - no more searches performed, because FindFirst()/FindNext() returned NULL
- update video config menu
? loading Win32 mods (Wine)
- hardware gamma (see /usr/X11R6/bin/xgamma as example ...)
- LoadRefresh: "vid_ref->modified = false" when OK
